---
title: 'JS30 - 06 AJAX Type Ahead'
date: '2025-02-12'
tags: ['JS30', 'JavaScript']
draft: false
summary: 'JS30 Day6 æŒ‘æˆ°ï¼Œé€é JSON æª”æ¡ˆè®€å–åŸå¸‚è³‡æ–™ï¼Œæ ¹æ“šä½¿ç”¨è€…è¼¸å…¥çš„é—œéµå­—ç¯©é¸ç¬¦åˆæ¢ä»¶çš„åŸå¸‚æˆ–å·ï¼Œä¸¦é¡¯ç¤ºåœ¨ç•«é¢ä¸Š'
authors: ['default']
images: ['/static/images/JS30.jpg']
canonicalUrl:
---

![](https://mhchihuahua.github.io/JavaScript30/images/06.png)

ğŸš€ [Demo Link](https://mhchihuahua.github.io/JavaScript30/06/)

é€é JSON æª”æ¡ˆè®€å–åŸå¸‚è³‡æ–™ï¼Œæ ¹æ“šä½¿ç”¨è€…è¼¸å…¥çš„é—œéµå­—ç¯©é¸ç¬¦åˆæ¢ä»¶çš„åŸå¸‚æˆ–å·ï¼Œä¸¦é¡¯ç¤ºåœ¨ç•«é¢ä¸Š

- ä½¿ç”¨ `fetch` è®€å– JSON æª”æ¡ˆ
- é€é `RegExp` å»ºç«‹æ­£è¦è¡¨é”å¼ï¼Œé€²è¡Œé—œéµå­—çš„æ¯”å°

---

## ğŸ“Œ Fetch API

åŸç¨‹å¼ä¸­æœ‰å®šç¾© endpoint è®Šæ•¸ï¼Œå€¼æ˜¯ JSON æª”æ¡ˆçš„ URLï¼Œè£¡é¢æœ‰åŸå¸‚å’Œå·çš„è³‡æ–™

```javascript
const endpoint =
  'https://gist.githubusercontent.com/Miserlou/c5cd8364bf9b2420bb29/raw/2bf258763cdddd704f8ffd3ea9a3e81d25e2c6f6/cities.json'
```

é€é `fetch()` ç”¨ä¾†ç²å–ç¶²è·¯è³‡æºï¼Œæœƒå›å‚³ `Promise`ï¼Œå¯ä»¥ä½¿ç”¨ `.then()` ä¾†è™•ç†å›å‚³çš„è³‡æ–™

```javascript
const cities = []

fetch(endpoint)
  .then((res) => res.json())
  .then((data) => cities.push(...data))
  .catch((error) => console.error(error))
```

- `fetch` æœƒå›å‚³ `Response` ç‰©ä»¶ï¼Œå…¶ body å±¬æ€§æ˜¯ä¸€å€‹ `ReadableStream` å¯¦é«”ï¼Œå¯ä»¥ä½¿ç”¨ `json()` æ–¹æ³•å°‡å…¶è½‰æ›ç‚º JSON æ ¼å¼
- `cities` ç”¨ä¾†å„²å­˜ JSON æª”æ¡ˆä¸­çš„åŸå¸‚è³‡æ–™ï¼Œä½¿ç”¨ `push` æ–¹æ³•å°‡è³‡æ–™åŠ å…¥é™£åˆ—ä¸­ï¼Œä¸¦ä½¿ç”¨å±•é–‹é‹ç®—å­ `...` ä¾†å±•é–‹è³‡æ–™ï¼Œä¸ç„¶æœƒè®ŠæˆåµŒå¥—é™£åˆ—

## ğŸ“Œ RegExp

`RegExp` æ˜¯ JavaScript çš„å…§å»ºç‰©ä»¶ï¼Œç”¨ä¾†å»ºç«‹æ­£è¦è¡¨é”å¼ï¼Œå¯ä»¥æ¯”å°å­—ä¸²

1. æ¯”è¼ƒä½¿ç”¨è€…è¼¸å…¥çš„é—œéµå­—èˆ‡ cities ä¸­çš„åŸå¸‚æˆ–å·åç¨±ï¼š

   ```javascript
   const findMatches = (wordToMatch, cities) => {
     return cities.filter((place) => {
       const regex = new RegExp(wordToMatch, 'gi')
       return place.city.match(regex) || place.state.match(regex)
     })
   }
   ```

   - `filter()`ï¼šéæ¿¾ç¬¦åˆæ¢ä»¶çš„å…ƒç´ ï¼Œå›å‚³ä¸€å€‹æ–°é™£åˆ—
   - `gi`ï¼šå…¨åŸŸæœå°‹ï¼ˆglobalï¼‰å’Œä¸å€åˆ†å¤§å°å¯«ï¼ˆcase-insensitiveï¼‰
   - `match()`ï¼šæœƒå›å‚³ä¸€å€‹é™£åˆ—ï¼ŒåŒ…å«ç¬¦åˆæ­£è¦è¡¨é”å¼çš„å­—ä¸²ï¼Œå¦‚æœæ²’æœ‰ç¬¦åˆçš„è©±ï¼Œæœƒå›å‚³ `null`

2. å°‡æ•¸å­—æ ¼å¼åŒ–åŠ ä¸Šåƒåˆ†ä½ç¬¦è™Ÿï¼Œè®“äººæ•¸çš„é¡¯ç¤ºæ›´æ˜“è®€ï¼š

   ```javascript
   const numberWithCommas = (number) => {
     return number.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ',')
   }
   ```

   - `replace()`ï¼šåˆ©ç”¨é€—è™Ÿæ›¿æ›ç¬¦åˆæ­£è¦è¡¨é”å¼çš„éƒ¨åˆ†
   - `/\B(?=(\d{3})+(?!\d))/g`
     - `\B`ï¼šéå–®å­—é‚Šç•Œï¼Œé¿å…æ•¸å­—é–‹é ­åŠ é€—è™Ÿ
     - `(?=...)`ï¼šæ­£å‘é æŸ¥(positive lookahead)ï¼Œç¢ºä¿å¾Œé¢æ˜¯æŒ‡å®šçš„æ¨¡å¼
     - `(\d{3})`+ï¼šè¡¨ç¤ºåŒ¹é… 3 ä½æ•¸å­—çš„ç¾¤çµ„ï¼Œå¯ä»¥é‡è¤‡å¤šæ¬¡
     - `(?!\d)`ï¼šè² å‘é æŸ¥(negative lookahead)ï¼Œç¢ºä¿å¾Œé¢æ²’æœ‰æ•¸å­—
     - `g`ï¼šå…¨å±€åŒ¹é…

---

## åƒè€ƒè³‡æ–™

- [Window: fetch() method](https://developer.mozilla.org/en-US/docs/Web/API/Window/fetch)
- [Response](https://developer.mozilla.org/en-US/docs/Web/API/Response)
- [ReadableStream](https://developer.mozilla.org/en-US/docs/Web/API/ReadableStream)
- [Response: json() method](https://developer.mozilla.org/en-US/docs/Web/API/Response/json)
- [Regular expressions](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Regular_expressions)
- [String.prototype.match()](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String/match)
