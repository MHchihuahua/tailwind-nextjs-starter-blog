---
title: 'JS30 - 08 Fun with HTML5 Canvas'
date: '2025-02-15'
tags: ['JS30', 'JavaScript']
draft: false
summary: 'JS30 Day8 æŒ‘æˆ°ï¼ŒCanvas ç•«åœ–æ‡‰ç”¨ï¼Œç•¶æ»‘é¼ é»æ“Šæ™‚ï¼Œå¯ä»¥åœ¨ç•«å¸ƒä¸Šç¹ªè£½å½©è™¹è‰²çš„ç·šæ¢ï¼Œä¸¦ä¸”éš¨è‘—æ»‘é¼ ç§»å‹•è€Œæ”¹è®Šç·šæ¢çš„é¡è‰²å’Œå¯¬åº¦'
authors: ['default']
images: ['/static/images/JS30.jpg']
canonicalUrl:
---

![](https://mhchihuahua.github.io/JavaScript30/images/08.png)

ğŸš€ [Demo Link](https://mhchihuahua.github.io/JavaScript30/08/)

Canvas ç•«åœ–æ‡‰ç”¨ï¼Œç•¶æ»‘é¼ é»æ“Šæ™‚ï¼Œå¯ä»¥åœ¨ç•«å¸ƒä¸Šç¹ªè£½å½©è™¹è‰²çš„ç·šæ¢ï¼Œä¸¦ä¸”éš¨è‘—æ»‘é¼ ç§»å‹•è€Œæ”¹è®Šç·šæ¢çš„é¡è‰²å’Œå¯¬åº¦

- ä½¿ç”¨ HTML5 Canvas ç¹ªè£½ç•«å¸ƒ
- æ»‘é¼ äº‹ä»¶ï¼š`mousedown`, `mousemove`, `mouseup`, `mouseout`

---

## è¨­å®š Canvas ç•«å¸ƒ

è¦èƒ½åœ¨ canvas ä¸Šç•«åœ–ï¼Œéœ€è¦å…ˆå–å¾— canvas å…ƒç´ ï¼Œä¸¦ä¸”å–å¾— 2D ç¹ªåœ–ç’°å¢ƒ

```javascript
const canvas = document.querySelector('#draw')
const ctx = canvas.getContext('2d')
```

## è¨­å®šç•«å¸ƒå¤§å°èˆ‡ç¹ªåœ–æ¨£å¼

canvas çš„å¤§å°é è¨­æ˜¯ 300\*150ï¼Œå¯ä»¥é€é JavaScript è¨­å®šç•«å¸ƒçš„å¤§å°ï¼Œä»¥åŠå…¶ä»–é è¨­çš„ç¹ªåœ–æ¨£å¼

```javascript
canvas.width = window.innerWidth
canvas.height = window.innerHeight - 150
ctx.lineWidth = 5
ctx.lineJoin = 'round'
ctx.lineCap = 'round'
```

- è¨­å®š canvas çš„å¯¬é«˜ç‚ºæ•´å€‹è¦–çª—å¤§å°ï¼Œè®“ç•«å¸ƒèƒ½å¡«æ»¿æ•´å€‹ç•«é¢
  - å› ç‚ºæœ€ä¸Šé¢æœ‰è¨­ä¸€å€‹ "HTML5 canvas" æ¨™é¡Œï¼Œæ‰€ä»¥ height æ¸›å» 150 æ˜¯ç‚ºäº†é¿å…ç•«å¸ƒè¢«é®æ“‹
- `lineWidth`ï¼šç·šæ¢çš„å¯¬åº¦
- `lineJoin`ï¼šç·šæ¢ç›¸äº¤çš„æ¨£å¼ï¼Œ`round` è¡¨ç¤ºåœ“è§’
- `lineCap`ï¼šç·šæ¢çš„ç«¯é»æ¨£å¼ï¼Œ`round` è¡¨ç¤ºåœ“è§’

### ç›¸é—œè®Šæ•¸

è™•ç†å®Œç•«å¸ƒçš„è¨­å®šå¾Œï¼Œå¯ä»¥è¨­å®šä¸€äº›è®Šæ•¸ä¾†æ§åˆ¶ç¹ªåœ–çš„è¡Œç‚ºï¼Œä¾‹å¦‚æ˜¯å¦æ­£åœ¨ç¹ªç•«ã€å‰ä¸€å€‹åº§æ¨™ã€è‰²ç›¸å€¼ã€ç·šæ¢å¯¬åº¦æ˜¯å¦å¢åŠ ç­‰ç­‰

```javascript
let isPainting = false
let prevX = 0
let prevY = 0
let hueValue = 0
let isIncreasingWidth = true
```

- `isPainting`ï¼šæ˜¯å¦æ­£åœ¨ç¹ªç•«
- `prevX`ã€`prevY`ï¼šç´€éŒ„å‰ä¸€å€‹åº§æ¨™çš„ x, y å€¼
- `hueValue`ï¼šæ§åˆ¶ç­†åˆ·é¡è‰²ï¼Œä½¿ç”¨ HSL è‰²å½©æ¨¡å¼ï¼ˆè‰²ç›¸ hue æœƒéš¨è‘—ç•«ç•«è®ŠåŒ–ï¼Œç”¢ç”Ÿå½©è™¹æ•ˆæœï¼‰
- `isIncreasingWidth`ï¼šæ§åˆ¶ç·šæ¢å¯¬åº¦æ˜¯å¦å¢åŠ çš„ flag

## ç¹ªè£½ç•«å¸ƒ

```javascript
const paint = (e) => {
  if (!isPainting) return

  ctx.strokeStyle = `hsl(${hueValue}, 100%, 50%)`
  ctx.beginPath()
  ctx.moveTo(prevX, prevY)
  ctx.lineTo(e.offsetX, e.offsetY)
  ctx.stroke()
  [prevX, prevY] = [e.offsetX, e.offsetY]
  hueValue = (hueValue + 1) % 360

  if (ctx.lineWidth >= 50 || ctx.lineWidth < 5) {
    isIncreasingWidth = !isIncreasingWidth
  }

  isIncreasingWidth ? ctx.lineWidth++ : ctx.lineWidth--
}
```

- ctx çš„å±¬æ€§è¨­å®šï¼š
  - `strokeStyle`ï¼šè¨­å®šç·šæ¢çš„é¡è‰²ï¼Œä½¿ç”¨ HSL è‰²å½©æ¨¡å¼ï¼Œè‰²ç›¸å€¼ `hueValue` æœƒéš¨è‘—ç•«ç•«è®ŠåŒ–ï¼Œç”¢ç”Ÿå½©è™¹æ•ˆæœ
  - `beginPath()`ï¼šé–‹å§‹ä¸€æ¢æ–°çš„è·¯å¾‘
  - `moveTo()`ï¼šè¨­å®šè·¯å¾‘çš„èµ·é»
  - `lineTo()`ï¼šè¨­å®šè·¯å¾‘çš„çµ‚é»
  - `stroke()`ï¼šç¹ªè£½è·¯å¾‘
- `prevX`ã€`prevY` æ›´æ–°ç‚ºç•¶å‰çš„åº§æ¨™
- `hueValue` è®“è‰²ç›¸å€¼åœ¨ 0~360 ä¹‹é–“å¾ªç’°ï¼Œæ¯æ¬¡ç•«ç·šæ™‚å¢åŠ  1ï¼Œç•¶è¶…é 360 æœƒæ­¸é›¶ï¼Œå½¢æˆå½©è™¹è‰²è®ŠåŒ–
- é€é `isIncreasingWidth` æ§åˆ¶ç·šæ¢å¯¬åº¦ï¼Œæœƒåœ¨ `lineWidth` é”åˆ° 50 æˆ– 5 æ™‚åè½‰æ–¹å‘ï¼Œä½¿ç·šæ¢å¯¬åº¦ä¾†å›è®ŠåŒ–ï¼Œç”¢ç”Ÿå‹•æ…‹æ•ˆæœ

## æ»‘é¼ äº‹ä»¶

æ§åˆ¶ç•¶æ»‘é¼ æŒ‰ä¸‹æ™‚é–‹å§‹ç¹ªç•«ï¼Œæ»‘é¼ ç§»å‹•æ™‚ç¹ªè£½è·¯å¾‘ï¼Œæ»‘é¼ æ”¾é–‹æ™‚åœæ­¢ç¹ªç•«

````javascript
const stopPainting = () => (isPainting = false);

canvas.addEventListener("mousemove", paint);
canvas.addEventListener("mousedown", (e) => {
    isPainting = true;
    [prevX, prevY] = [e.offsetX, e.offsetY];
});
canvas.addEventListener("mouseup", stopPainting);
canvas.addEventListener("mouseout", stopPainting);
```

- `mousemove`ï¼šç•¶æ»‘é¼ ç§»å‹•æ™‚ï¼Œè§¸ç™¼ `paint` å‡½å¼ï¼Œç¹ªè£½è·¯å¾‘
- `mousedown`ï¼šç•¶æ»‘é¼ æŒ‰ä¸‹æ™‚ï¼Œè¨­å®š `isPainting` ç‚º `true`ï¼Œä¸¦ä¸”è¨­å®šèµ·å§‹åº§æ¨™
    - è¨­å®š `[prevX, prevY]` æ˜¯ç‚ºäº†ç¢ºä¿ç¹ªç•«å¾æ»‘é¼ é»æ“Šçš„ä½ç½®é–‹å§‹ï¼Œé¿å…ç•«ç·šçš„éŒ¯èª¤
- `mouseup`ã€`mouseout`ï¼šç•¶æ»‘é¼ æ”¾é–‹æˆ–ç§»å‡ºç•«å¸ƒæ™‚ï¼Œåœæ­¢ç¹ªç•«

---

## åƒè€ƒè³‡æ–™

- [Basic usage of canvas](https://developer.mozilla.org/en-US/docs/Web/API/Canvas_API/Tutorial/Basic_usage)
- [hsl()](https://developer.mozilla.org/en-US/docs/Web/CSS/color_value/hsl)
````
